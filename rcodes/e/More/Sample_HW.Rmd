---
title: "STA6856 Time Series Analysis"
author: "Student A"
date: "3/11/2021"
output:
  html_document:
    df_print: paged
  pdf_document: default
course: STA 6856 - Time Series Analysis
---

# Sample Problem 

**
Fit an ARIMA(p,d,q) model to Lake Data.
**
```{r}
# loading package 
library(datasets)
library(DT)
data(LakeHuron)
# Plotting
plot(LakeHuron,type="o",xlab="Annual")

```


The plot of series does not show seasonality but it may suggest a trend. I can see a positive dependence also.

**
1. Examine ACF and PACF
**
```{r}
library(itsmr)
plota(LakeHuron)
```

```
The ACF shows a significant decaying up to lag 10 and the two first PACF coefficients are significant. The data suggests an AR(2) model.
```

**
2. Test Stationary hypothesis
**
```{r}
library(aTSA)
adf.test(LakeHuron)
```

The test shows that the data is not stationary. This is expected because the data showed a trend component. Thus, we shall estimate and eliminate the trend.

**
3. Estimate the trend
**

```{r}
M=c("trend",1)
R=Resid(LakeHuron,M)
# Test stationary
adf.test(R)
# Test iid hypothesis
test(R)
```

The ADF test suggests that the data is stationary where the model is with no trend and no drift. However, the IID test rejected the null hypothesis of IID noise, therefore we need to fit an ARMA(p,q) to the residuals R.


**
4.Fit AR(2)
**

```{r}
# Fit model 1
ar.model= arima(R,order = c(2,0,0))
ar.model
# CI
confint(ar.model)
```

```
The model has a significant AR coefficients but an intercept that is not significantly different than zero.
```


```{r}
# Diagnostics model
test(ar.model$residuals)
```


```
Residuals are IDD.

```

**
5.Final equation of the model
**
\begin{equation}
X_t = m_t + Y_t
\end{equation}
where 
\begin{equation}
m_t=580.2 - 0.02t 
\end{equation}

and 
\begin{equation}
Y_t= Y_{t-1} - 0.292Y_{t-2} + Z_t
\end{equation} 

where $Z_t \sim WN(0,0.457)$


**
5. Comparing models
**

```{r}
# Fit model 1
model2= arima(R,order = c(2,0,0))
model2
# CI
confint(model2)
# diagnostics
test(model2$residuals)
```

